<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover, interactive-widget=overlays-content">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<meta name="theme-color" content="#0a0033">
<title>Hopmos Friday Drops</title>
<script src="https://html2canvas.hertzen.com/dist/html2canvas.min.js"></script>
<style>
  *{margin:0;padding:0;box-sizing:border-box}
  html,body{
    height:100%;
    height:100dvh;
    overflow:hidden;
    font-family:'Segoe UI',sans-serif;
    color:#fff;
    background:#0a0033;
  }

  /* Header floats fixed – never moves */
  #header{
    position:fixed;
    top:0;
    left:0;
    right:0;
    height:90px;
    padding-top:env(safe-area-inset-top, 20px);
    background:rgba(10,0,51,0.95);
    backdrop-filter:blur(10px);
    -webkit-backdrop-filter:blur(10px);
    display:flex;
    align-items:center;
    justify-content:space-between;
    padding-left:20px;
    padding-right:20px;
    z-index:9999;
    border-bottom:4px solid #00ff00;
    box-shadow:0 8px 30px rgba(0,255,0,0.5);
  }
  #score,#timer{
    font-size:21px;
    font-weight:900;
    color:#00ff00;
    text-shadow:0 0 20px #00ff00;
    background:rgba(0,0,0,0.5);
    padding:8px 18px;
    border-radius:30px;
    border:2px solid #00ff00;
  }

  #app{
    padding-top:100px;
    padding-bottom:200px;
    height:100dvh;
    background:linear-gradient(135deg,#0a0033,#1a0059,#2d0077);
    display:flex;
    flex-direction:column;
    align-items:center;
    justify-content:center;
  }

  #word-container{width:100%;text-align:center;padding:0 20px}
  #word-display{
    display:inline-block;
    font-weight:900;
    letter-spacing:7px;
    font-size:9vw;
    line-height:1.3;
  }
  @media(min-width:500px){#word-display{font-size:54px}}
  @media(max-width:360px){#word-display{font-size:40px}}

  .letter{transition:all .2s}
  .typed{color:#00ff00 !important;text-shadow:0 0 30px #00ff00}
  .current{background:rgba(0,255,0,0.4);padding:0 12px;border-radius:12px}

  #feedback{
    position:fixed;top:50%;left:50%;transform:translate(-50%,-50%);
    font-size:36px;font-weight:900;color:#00ff00;background:rgba(0,0,0,0.9);
    padding:18px 55px;border-radius:50px;opacity:0;box-shadow:0 0 50px #00ff00;
    z-index:9998;transition:opacity .4s
  }
  #feedback.show{opacity:1}

  #input{
    position:fixed;
    bottom:calc(env(safe-area-inset-bottom, 30px) + 30px);
    left:50%;
    transform:translateX(-50%);
    width:94%;
    max-width:420px;
    padding:24px;
    font-size:32px;
    text-align:center;
    border:6px solid #00ff00;
    border-radius:50px;
    background:rgba(0,0,0,0.85);
    outline:none;
    color:#fff;
    z-index:9997;
    box-shadow:0 0 50px rgba(0,255,0,0.7);
  }

  .screen{
    position:fixed;top:0;left:0;width:100%;height:100dvh;
    display:flex;flex-direction:column;align-items:center;justify-content:center;
    text-align:center;padding:20px;background:rgba(0,0,0,0.97);z-index:10000
  }

  h1{font-size:3.8rem;background:linear-gradient(90deg,#00ff00,#00ffaa,#00cc00);
     -webkit-background-clip:text;-webkit-text-fill-color:transparent;font-weight:900;letter-spacing:4px}

  button{margin:30px auto;padding:22px 80px;font-size:28px;background:#00ff00;color:#000;
         border:none;border-radius:50px;cursor:pointer;font-weight:900;
         box-shadow:0 12px 40px rgba(0,255,0,0.6)}

  #prize-card{background:linear-gradient(135deg,#1a0033,#000);border:5px solid #00ff00;border-radius:30px;
              padding:40px;width:92%;max-width:440px;box-shadow:0 0 60px rgba(0,255,0,0.6);
              text-align:center;margin:20px auto}
  #prize-logo{font-size:56px;font-weight:900;color:#00ff00;letter-spacing:5px}
  #prize-amount{font-size:68px;color:#00ff00;font-weight:900;text-shadow:0 0 50px #00ff00}
  .line{border-top:4px dashed #00ff00;margin:30px 0;opacity:0.7}

  input,select{width:90%;max-width:380px;margin:15px auto;padding:20px;font-size:22px;border-radius:20px;
              border:none;text-align:center;background:rgba(255,255,255,0.15);color:#fff}
  select{background:#333}
  #submit-btn{background:#ffd700;color:#000;box-shadow:0 12px 40px rgba(255,215,0,0.7)}
</style>
</head>
<body>

<!-- FLOATING HEADER – NEVER MOVES OR ADJUSTS -->
<div id="header">
  <div id="score">Score: 0 (₦0)</div>
  <div id="timer">Time: 120s</div>
</div>

<div id="app">

  <!-- Start -->
  <div id="start-screen" class="screen">
    <h1>HOPMOS FRIDAY DROPS</h1>
    <p>Short word = ₦15<br>Long word (10+ letters) = ₦20</p>
    <div style="font-size:3.5rem;color:#00ff00;margin:30px">120 seconds</div>
    <button onclick="startGame()">START DROPS</button>
  </div>

  <!-- Game -->
  <div id="game-screen" style="display:none">
    <div id="word-container"><div id="word-display"></div></div>
    <div id="feedback">CORRECT!</div>
    <input type="text" id="input" placeholder="Type here..." autocomplete="off" autocorrect="off" spellcheck="false">
  </div>

  <!-- Result -->
  <div id="result-screen" class="screen" style="display:none">
    <h1>HOPMOS FRIDAY DROPS</h1>
    <div style="font-size:3.6rem;color:#00ff00">TIME UP!</div>
    <p>Your final prize:</p>
    <div id="prize-card">
      <div id="prize-logo">HOPMOS</div>
      <div id="prize-amount">₦0</div>
      <div class="line"></div>
      <div style="font-size:20px;color:#ccc">Friday Drops Winner<br>Correct Words: <span id="words-count">0</span></div>
    </div>
    <button onclick="showClaimForm()">CLAIM YOUR MONEY</button>
  </div>

  <!-- Claim -->
  <div id="claim-screen" class="screen" style="display:none">
    <h1>CLAIM YOUR PRIZE</h1>
    <div id="prize-card">
      <div id="prize-logo">HOPMOS</div>
      <div id="prize-amount">₦<span id="capture-amount">0</span></div>
      <div class="line"></div>
      <div style="color:#ccc">
        Winner Details:<br><br>
        <input type="text" id="name" placeholder="Full Name" required>
        <input type="tel" id="phone" placeholder="Phone Number" required>
        <select id="network" required>
          <option value="" disabled selected>Network</option>
          <option>MTN</option><option>Airtel</option><option>Glo</option><option>9mobile</option>
        </select>
      </div>
    </div>
    <button id="submit-btn" onclick="submitAndSend()">SUBMIT & SEND TO WHATSAPP</button>
  </div>

</div>

<audio id="bgmusic" loop autoplay volume="0.5">
  <source src="https://cdn.pixabay.com/download/audio/2023/08/03/audio_2c8f8d17e5.mp3?filename=afrobeat-no-copyright-music-162665.mp3" type="audio/mp3">
</audio>

<script>
// Prevent layout shift with VirtualKeyboard API
if ('virtualKeyboard' in navigator) {
  navigator.virtualKeyboard.overlaysContent = true;
  navigator.virtualKeyboard.addEventListener('geometrychange', () => {
    document.body.style.paddingBottom = navigator.virtualKeyboard.boundingRect.height + 'px';
  });
}

// FIX VIEWPORT TO PREVENT RESIZE ON KEYBOARD OPEN
window.addEventListener('load', () => {
  const initialHeight = window.innerHeight;
  const initialWidth = window.innerWidth;
  const viewport = document.querySelector('meta[name=viewport]');
  viewport.content = `width=${initialWidth}, height=${initialHeight}, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no`;
  document.body.style.height = `${initialHeight}px`;
  document.body.style.width = `${initialWidth}px`;
});

// IGNORE RESIZE FROM KEYBOARD
let isKeyboardOpen = false;
window.addEventListener('resize', () => {
  if (document.activeElement.tagName === 'INPUT' || document.activeElement.tagName === 'TEXTAREA') {
    isKeyboardOpen = true;
    // Don't adjust layout
  } else if (isKeyboardOpen) {
    isKeyboardOpen = false;
    // Keyboard closed, optional adjust
  } else {
    // Real resize (orientation change), adjust if needed
    location.reload(); // Optional reload for orientation
  }
});

const words = ["HOPMOS","IDORENYIN","POUNDED","EGUSI","PEPPER","OWAMBE","ASOEBI","ANKARA","AGBADA","ISIAGU","ABUJA","LAGOS","CALABAR","ENUGU","KANO","IBADAN","INDOMIE","AKARA","MOIMOI","FUFU","GARRI","ZANKU","SHAKITI","DEYPLAY","NOWAHALA","JAPA","SAPA","WEREY","OSHEY","GBEDU","KPK","ECHOKE","CRUISE","BROKOS","OGAKPATA","MADAMKOI","HOWFAR","WETIN","SHINE","VEXMONEY","PUREWATER","CHAPMAN","ZOBODRINK","KILISHI","ASUN","NKWOBI","ISIEWU","SUYA","JOLLOF","AFANG"];

let score = 0, totalPrize = 0, timeLeft = 120, gameActive = false;
let remainingWords = [];

const wordDisplay = document.getElementById('word-display');
const input = document.getElementById('input');
const feedback = document.getElementById('feedback');

function startGame(){
  document.getElementById('start-screen').style.display='none';
  document.getElementById('game-screen').style.display='block';
  document.getElementById('bgmusic').play().catch(()=>{});
  score=0; totalPrize=0; timeLeft=120; gameActive=true;
  remainingWords = [...words];
  updateScore(); startTimer(); showNextWord(); setTimeout(()=>{input.focus()},500);
}

function startTimer(){
  const t = setInterval(()=>{
    timeLeft--;
    document.getElementById('timer').textContent = `Time: ${timeLeft}s`;
    if(timeLeft<=0){clearInterval(t); endGame();}
  },1000);
}

function showNextWord(){
  if(!gameActive || remainingWords.length===0) return;
  const word = remainingWords.shift();
  wordDisplay.innerHTML = word.split('').map(l=>`<span class="letter">${l}</span>`).join('');
  input.value=''; highlightTyped(0);
}

function highlightTyped(n){
  document.querySelectorAll('.letter').forEach((l,i)=>{
    l.classList.toggle('typed',i<n);
    l.classList.toggle('current',i===n);
  });
}

function updateScore(){
  document.getElementById('score').textContent = `Score: ${score} (₦${totalPrize})`;
}

function showFeedback(){
  feedback.classList.add('show');
  setTimeout(()=>feedback.classList.remove('show'),800);
}

function endGame(){
  gameActive=false; input.disabled=true;
  document.getElementById('game-screen').style.display='none';
  document.getElementById('prize-amount').textContent = `₦${totalPrize}`;
  document.getElementById('capture-amount').textContent = totalPrize;
  document.getElementById('words-count').textContent = score;
  document.getElementById('result-screen').style.display='flex';
}

function showClaimForm(){
  document.getElementById('result-screen').style.display='none';
  document.getElementById('claim-screen').style.display='flex';
}

input.addEventListener('input',()=>{
  if(!gameActive) return;
  const typed = input.value.toUpperCase().trim();
  const current = wordDisplay.textContent;
  if(current.startsWith(typed)){
    highlightTyped(typed.length);
    if(typed===current){
      score++;
      totalPrize += current.length >= 10 ? 20 : 15;
      updateScore(); showFeedback();
      input.value=''; setTimeout(showNextWord,800);
    }
  }else if(typed.length>0){
    input.style.borderColor='#ff0066';
    setTimeout(()=>input.style.borderColor='#00ff00',300);
  }
});

function submitAndSend(){
  const name = document.getElementById('name').value.trim();
  const phone = document.getElementById('phone').value.trim();
  const network = document.getElementById('network').value;
  if(!name || !phone || !network){ alert("Fill all fields"); return; }

  document.getElementById('submit-btn').textContent = "Sending...";
  html2canvas(document.getElementById('prize-card'), {scale: 2}).then(canvas => {
    canvas.toBlob(blob => {
      const file = new File([blob], "Hopmos-Winner.png", {type: "image/png"});
      const text = `HOPMOS FRIDAY DROPS WINNER!\nName: ${name}\nPhone: ${phone}\nNetwork: ${network}\nPrize: ₦${totalPrize}`;
      if(navigator.canShare && navigator.canShare({files: [file]})){
        navigator.share({files: [file], text: text});
      } else {
        window.open("https://wa.me/qr/YIYYT7HG2AAJI1?text=" + encodeURIComponent(text), '_blank');
      }
      document.getElementById('submit-btn').textContent = "SENT!";
    });
  });
}
</script>
</body>
</html>
